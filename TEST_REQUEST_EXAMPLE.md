# Пример запроса для проверки расчетов

## Тестовый запрос (данные со скриншота)

```bash
curl -X POST http://localhost:3000/api/calculate \
  -H "Content-Type: application/json" \
  -H "x-api-key: your-api-key" \
  -H "Authorization: Basic $(echo -n 'username:password' | base64)" \
  -d '{
    "lat": 48.480223,
    "lon": 135.071917,
    "order": {
      "weight": 0.1,
      "volume": 0.1,
      "cost": 10000
    }
  }'
```

## Проверка расчета по шагам:

### Входные данные:
- Вес: 0.1 кг
- Объем: 0.1 м³
- Стоимость заказа: 10000 руб

### Расчет по формулам:

1. **Реальная доля загрузки:**
   - По весу: 0.1 / 2000 = 0.00005 (0.005%)
   - По объему: 0.1 / 9 = 0.01111... (1.11%)
   - MAX = 0.01111... ✅ (совпадает со скриншотом)

2. **Необходимое количество рейсов:**
   - ОКРУГЛВВЕРХ(0.01111) = 1 ✅

3. **Дополнительные рейсы:**
   - 1 - 1 = 0 ✅

4. **Реальная доля загрузки с учетом минимума:**
   - Рейсов <= 1, поэтому: MAX(0.743, 0.01111) = 0.743 ✅

5. **Время работ (погрузка/разгрузка):**
   - 0.743 * 0.5 = 0.3715 часа ✅

6. **Среднее время доставки по городу:**
   - 7 / 20 = 0.35 часа ✅

7. **Время доставки с учетом % загрузки:**
   - 0.35 * 0.743 = 0.26005 часа ✅

8. **Итоговая себестоимость:**
   - ((0.26005 + 0.3715) * 850) + 100 = 636.8175 руб ✅

9. **Итоговая стоимость для клиента:**
   - ОКРУГЛВНИЗ(636.8175 * 1.10) = ОКРУГЛВНИЗ(700.49925) = 700 руб ✅

10. **Экспресс доставка себестоимость:**
    - 636.8175 * 1.1425 = 727.5639938 руб ✅

11. **Экспресс доставка стоимость клиента:**
    - ОКРУГЛВНИЗ(727.5639938 * 1.10) = ОКРУГЛВНИЗ(800.3203931) = 800 руб ✅

## Ожидаемый ответ:

```json
{
  "delivery_cost": 700,
  "delivery_time": "1-2 дня",
  "express_delivery_cost": 800,
  "options": [
    {
      "name": "Экспресс доставка",
      "cost": 800,
      "description": "Приоритетная доставка"
    }
  ],
  "zoneInfo": {
    "inZone": true,
    "zoneName": "Зона доставки — Хабаровск"
  }
}
```

## Другие примеры запросов:

### Большой заказ (превышение грузоподъемности):
```json
{
  "lat": 48.480223,
  "lon": 135.071917,
  "order": {
    "weight": 2500,
    "volume": 8,
    "cost": 100000
  }
}
```

### Объемный но легкий груз:
```json
{
  "lat": 48.480223,
  "lon": 135.071917,
  "order": {
    "weight": 100,
    "volume": 10,
    "cost": 50000
  }
}
```

### Тяжелый но компактный груз:
```json
{
  "lat": 48.480223,
  "lon": 135.071917,
  "order": {
    "weight": 1800,
    "volume": 2,
    "cost": 75000
  }
}
```
